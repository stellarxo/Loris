<?
require_once 'NDB_Factory.class.inc';
class NDAR_Release {
    function __construct($instrument) {
        $this->instrument = $instrument;
    }

    function getWhere() {
        if(strpos($this->instrument, '_proband') !== FALSE) {
            $GUID = "AND c.ProbandGUID IS NOT NULL";
        } else {
            $GUID = "AND c.CandidateGUID IS NOT NULL";
        }
        $Base = "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5)";
        if($this->instrument == 'adi_r_proband') {
            // Check Summary_diagnosis=ASD+
            return $Base . " AND i.Summary_diagnosis='ASD+' $GUID";
        } else if($this->instrument == 'm_chat_proband') {
            // Check score=Fail and not Control
            return $Base . " AND s.SubprojectID <> 3 AND i.score='Fail' $GUID";
        } else if($this->instrument == 'scq_proband') {
            // Check scq_diagnosis=ASD_Positive and 6/12mo recruit
            return $Base . " AND s.SubprojectID IN (1, 2) AND i.scq_diagnosis='ASD Positive' $GUID";
        } else if($this->instrument == 'scq_subject') {
            return $Base . " AND s.SubprojectID=3 AND UPPER(s.Visit_label)='V24' $GUID";
        } else if ($this->instrument == 'vineland_proband') {
            return "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND s.CenterID IN (2, 3, 4, 5) AND s.SubprojectID IN (1, 2) $GUID";
        } else if($this->instrument == "vineland_subject") {
            return $Base . " AND ((s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')) OR (s.SubprojectID=1 AND UPPER(s.Visit_label)='V06')) $GUID";
        } else if ($this->instrument == 'prefrontal_task') {
            return $Base . " AND s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V12', 'V24') $GUID";
        }
        return $Base . " AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24'))) $GUID";
    }

    function getCommonFields() {
        if(strpos($this->instrument, '_proband') !== FALSE) {
            if($this->instrument == 'm_chat_proband') {
                // No validity
                return "c.IBISID, s.Visit_label, s.CenterID, CASE s.SubprojectID WHEN 1 THEN 'High Risk' WHEN 2 THEN 'High Risk' WHEN 3 THEN 'Control' END as Cohort, c.ProbandGUID, c.ProbandDoB, c.ProbandGender, ROUND(DATEDIFF(i.Date_taken, c.ProbandDoB) / (365/12)) AS Proband_Age_in_Months, i.Date_taken, ";
            }
            return "c.IBISID, s.Visit_label, s.CenterID, CASE s.SubprojectID WHEN 1 THEN 'High Risk' WHEN 2 THEN 'High Risk' WHEN 3 THEN 'Control' END as Cohort, c.ProbandGUID, c.ProbandDoB, c.ProbandGender, ROUND(DATEDIFF(i.Date_taken, c.ProbandDoB) / (365/12)) AS Proband_Age_in_Months, f.Validity, i.Date_taken, ";
        } else {
            $NoValidities = array('scq_subject', 'macarthur_words_gestures', 'rbs_r', 'seq', 'ibq_r', 'head_measurements_subject', 'prefrontal_task');
            if(in_array($this->instrument, $NoValidities)) {
                return "c.IBISID, s.Visit_label, s.CenterID, CASE s.SubprojectID WHEN 1 THEN 'High Risk' WHEN 2 THEN 'High Risk' WHEN 3 THEN 'Control' END as Cohort, c.CandidateGUID, c.DoB, c.Gender, ROUND(DATEDIFF(i.Date_taken, c.DoB) / (365/12)) AS Candidate_Age_in_Months, i.Date_taken, ";
            }
            return "c.IBISID, s.Visit_label, s.CenterID, CASE s.SubprojectID WHEN 1 THEN 'High Risk' WHEN 2 THEN 'High Risk' WHEN 3 THEN 'Control' END as Cohort, c.CandidateGUID, c.DoB, c.Gender, ROUND(DATEDIFF(i.Date_taken, c.DoB) / (365/12)) AS Candidate_Age_in_Months, f.Validity, i.Date_taken, ";
        }
    }
    function getInstrumentFields() {
        if($this->instrument == 'adi_r_proband') {
            $fields = array(
                'i.A_Total',
                'i.BNV_Total',
                'i.BV_Total',
                'i.C_Total',
                'i.D_Total',
                'i.Total_A1',
                'i.Total_A2',
                'i.Total_A3',
                'i.Total_A4',
                'i.Total_B1',
                'i.Total_B2V',
                'i.Total_B3V',
                'i.Total_B4',
                'i.Total_C1',
                'i.Total_C2',
                'i.Total_C3',
                'i.Total_C4',
                'i.summary_diagnosis',
                'i.informant_relation',
                'i.q_2_age_first_noticed_code',
                'i.q_4_onset_as_perceived_code',
                'i.q_5_first_walked_code',
                'i.q_6_bladder_daytime_code',
                'i.q_7_bladder_nighttime_code',
                'i.q_8_bowel_control_code',
                'i.q_9_first_single_words_code',
                'i.q_10_first_phrases_code',
                'i.q_11_loss_of_language',
                'i.q_12_level_before_loss_code',
                'i.q_13_loss_of_spontaneous_use_code',
                'i.q_14_loss_of_intent_code',
                'i.q_15_loss_of_syntactical_code',
                'i.q_16_loss_of_articulation_code',
                'i.q_17_main_loss_apparent_code',
                'i.q_18_loss_due_to_illness',
                'i.q_19_duration_of_loss_code',
                'i.q_20_loss_of_skills_code',
                'i.q_21_puposive_hand_movements_code',
                'i.q_22_motor_skills_code',
                'i.q_23_self_help_skills_code',
                'i.q_24_constructive_play_code',
                'i.q_25_social_engagement_code',
                'i.q_26_loss_first_apparent_code',
                'i.q_27_physical_illness_code',
                'i.q_28_duration_of_loss_code',
                'i.q_29_compreh_simple_current',
                'i.q_29_compreh_simple_most_abnormal',
                'i.q_30_overall_level_of_language',
                'i.q_31_use_of_others_body_current_code',
                'i.q_31_use_of_others_body_ever_code ',
                'i.q_32_artic_pronun_5years_code',
                'i.q_32_artic_pronun_current_code',
                'i.q_33_stereotyped_utterances_current_code',
                'i.q_33_stereotyped_utterances_ever_code',
                'i.q_34_social_verb_chat_current_code',
                'i.q_34_social_verb_chat_ever_code',
                'i.q_35_recipr_convers_current_code',
                'i.q_35_recipr_convers_ever_code',
                'i.q_36_inappropriate_qs_current_code',
                'i.q_36_inappropriate_qs_ever_code',
                'i.q_37_prenominal_reversal_current_code',
                'i.q_37_prenominal_reversal_ever_code',
                'i.q_38_neologisms_current_code',
                'i.q_38_neologisms_ever_code',
                'i.q_39_verbal_rituals_current_code',
                'i.q_39_verbal_rituals_ever_code',
                'i.q_40_inton_vol_rhythm_rate_current_code',
                'i.q_40_inton_vol_rhythm_rate_ever_code',
                'i.q_41_cur_comm_speech_at5_code',
                'i.q_41_cur_comm_speech_current_code',
                'i.q_42_point_express_inter_most_abnormal_code',
                'i.q_42_point_express_interest_current_code',
                'i.q_43_nodding_current_code',
                'i.q_43_nodding_most_abnormal_code',
                'i.q_44_head_shaking_current_code',
                'i.q_44_head_shaking_most_abnormal_code',
                'i.q_45_conventional_instr_gests_current_code',
                'i.q_45_conventional_instr_gests_most_abnormal_code',
                'i.q_46_attent_voice_current_code',
                'i.q_46_attent_voice_most_abnormal_code',
                'i.q_47_spont_imit_current_code',
                'i.q_47_spont_imit_most_abnormal_code',
                'i.q_48_imag_play_current_code',
                'i.q_48_imag_play_most_abnormal_code',
                'i.q_49_imag_play_peers_current_code',
                'i.q_49_imag_play_peers_most_abnormal_code',
                'i.q_50_direct_gaze_current_code',
                'i.q_50_direct_gaze_most_abnormal_code',
                'i.q_51_social_smiling_current_code',
                'i.q_51_social_smiling_most_abnormal_code',
                'i.q_52_show_direct_atten_current_code',
                'i.q_52_show_direct_atten_most_abnormal_code',
                'i.q_53_offer_share_current_code',
                'i.q_53_offer_share_most_abnormal_code',
                'i.q_54_seek_share_enjoy_current_code',
                'i.q_54_seek_share_enjoy_most_abnormal_code',
                'i.q_55_offer_comf_current_code',
                'i.q_55_offer_comf_most_abnormal_code',
                'i.q_56_qual_social_overts_current_code',
                'i.q_56_qual_social_overts_most_abnormal_code',
                'i.q_57_range_facial_expr_current_code',
                'i.q_57_range_facial_expr_most_abnormal_code',
                'i.q_58_inappropriate_facial_current_code',
                'i.q_58_inappropriate_facial_ever_code',
                'i.q_59_appropriat_resp_current_code',
                'i.q_59_appropriat_resp_most_abnormal_code',
                'i.q_60_init_activities_current_code',
                'i.q_60_init_activities_most_abnormal_code',
                'i.q_61_imit_soc_play_current_code',
                'i.q_61_imit_soc_play_most_abnormal_code',
                'i.q_62_inter_children_current_code',
                'i.q_62_inter_children_most_abnormal_code',
                'i.q_63_resp_approaches_current_code',
                'i.q_63_resp_approaches_most_abnormal_code',
                'i.q_64_group_play_peers_current_code',
                'i.q_64_group_play_peers_most_abnormal_code',
                'i.q_65_friendships_current_code',
                'i.q_65_friendships_most_abnormal_code',
                'i.q_66_soc_disinhibit_current_code',
                'i.q_66_soc_disinhibit_most_abnormal_code',
                'i.q_67_unusual_preoccupations_current_code',
                'i.q_67_unusual_preoccupations_ever_code',
                'i.q_68_circumscr_ints_current_code',
                'i.q_68_circumscr_ints_ever_code',
                'i.q_69_repet_use_objects_current_code',
                'i.q_69_repet_use_objects_ever_code',
                'i.q_70_compulsions_rituals_current_code',
                'i.q_70_compulsions_rituals_ever_code',
                'i.q_71_unusual_sens_ints_current_code',
                'i.q_71_unusual_sens_ints_ever_code',
                'i.q_72_undo_gen_sens_noise_current_code',
                'i.q_72_undo_gen_sens_noise_ever_code',
                'i.q_73_idiosyncratic_current_code',
                'i.q_73_idiosyncratic_ever_code',
                'i.q_74_diff_minor_changes_current_code',
                'i.q_74_diff_minor_changes_ever_code',
                'i.q_75_resist_trivial_chng_current_code',
                'i.q_75_resist_trivial_chng_ever_code',
                'i.q_76_unus_attach_objects_current_code',
                'i.q_76_unus_attach_objects_ever_code',
                'i.q_77_hands_finger_manners_current_code',
                'i.q_77_hands_finger_manners_ever_code',
                'i.q_78_oth_complex_manners_current_code',
                'i.q_78_oth_complex_manners_ever_code',
                'i.q_79_midline_hand_moves_current_code',
                'i.q_79_midline_hand_moves_ever_code',
                'i.q_80_gait_current_code',
                'i.q_80_gait_most_abnormal_code',
                'i.q_81_aggress_caregivers_current_code',
                'i.q_81_aggress_caregivers_ever_code',
                'i.q_82_aggress_noncaregivers_current_code',
                'i.q_82_aggress_noncaregivers_ever_code',
                'i.q_83_self_injury_current_code',
                'i.q_83_self_injury_ever_code',
                'i.q_84_hyperventilation_current_code',
                'i.q_84_hyperventilation_ever_code',
                'i.q_85_faints_fits_blackouts_current_code',
                'i.q_85_faints_fits_blackouts_ever_code',
                'i.q_86_age_when_abnormality_first_evident',
                'i.q_87_interviewers_judgment',
                'i.q_88_visuospatial_ability_current_code',
                'i.q_88_visuospatial_ability_ever_code',
                'i.q_89_memory_still_current_code',
                'i.q_89_memory_still_ever_code',
                'i.q_90_musical_ability_current_code',
                'i.q_90_musical_ability_ever_code',
                'i.q_91_drawings_skill_current_code',
                'i.q_91_drawings_skill_ever_code',
                'i.q_92_reading_ability_current_code',
                'i.q_92_reading_ability_ever_code',
                'i.q_93_computational_ability_current_code',
                'i.q_93_computational_ability_ever_code'
            );
        } else if($this->instrument === 'aosi') {
            $fields = array(
                'i.examiner_location',
                'i.total_score_1_18_override',
                'i.number_of_markers_override',
                'i.q1_visual_tracking_score_override',
                'i.q1_visual_tracking_notes',
                'i.q1_visual_tracking_notes_status',
                'i.q2_disengagement_of_attention_score_override',
                'i.q2_disengagement_of_attention_notes',
                'i.q2_disengagement_of_attention_notes_status',
                'i.free_play_period_1_notes',
                'i.free_play_period_1_notes_status',
                'i.q3_orients_to_name_score_override',
                'i.q3_orients_to_name_notes',
                'i.q3_orients_to_name_notes_status',
                'i.q4_differential_response_to_facial_emotion',
                'i.q4_differential_response_to_facial_emotion_notes',
                'i.q4_differential_response_to_facial_emotion_notes_status',
                'i.q5_anticipatory_response',
                'i.q5_anticipatory_response_notes',
                'i.q5_anticipatory_response_notes_status',
                'i.q6_imitation_of_actions_score_override',
                'i.q6_imitation_of_actions_notes',
                'i.q6_imitation_of_actions_notes_status',
                'i.free_play_period_2_notes',
                'i.free_play_period_2_notes_status',
                'i.q7_social_babbling',
                'i.q7_social_babbling_notes',
                'i.q7_social_babbling_notes_status',
                'i.q8_eye_contact',
                'i.q8_eye_contact_notes',
                'i.q8_eye_contact_notes_status',
                'i.q9_reciprocal_social_smile',
                'i.q9_reciprocal_social_smile_notes',
                'i.q9_reciprocal_social_smile_notes_status',
                'i.q10_coordination_of_eye_gaze_and_action',
                'i.q10_coordination_of_eye_gaze_and_action_notes',
                'i.q10_coordination_of_eye_gaze_and_action_notes_status',
                'i.q11_reactivity',
                'i.q11_reactivity_notes',
                'i.q11_reactivity_notes_status',
                'i.q14_social_interest',
                'i.q14_social_interest_notes',
                'i.q14_social_interest_notes_status',
                'i.q15_transitions',
                'i.q15_transitions_notes',
                'i.q15_transitions_notes_status',
                'i.q16_motor_control_and_behaviour',
                'i.q16_motor_control_and_behaviour_notes',
                'i.q16_motor_control_and_behaviour_notes_status',
                'i.q17_atypical_motor',
                'i.q17_atypical_motor_notes',
                'i.q17_atypical_motor_notes_status',
                'i.q18_atypical_sensory',
                'i.q18_atypical_sensory_notes',
                'i.q18_atypical_sensory_notes_status',
                'i.q19_engagement_of_attention',
                'i.q19_engagement_of_attention_notes',
                'i.q19_engagement_of_attention_notes_status',
                'i.q20_insistence_on_particular_objects',
                'i.q20_insistence_on_particular_objects_notes',
                'i.q20_insistence_on_particular_objects_notes_status',
                'i.q21_social_referencing',
                'i.q21_social_referencing_notes',
                'i.q21_social_referencing_notes_status',
            );
        } else if ($this->instrument == 'seq') {
            $fields = array(
                'i.Candidate_Age',
                'i.person_completing',
                'i.person_completing_other',
                'i.q1_react_sensitively',
                'i.q1_react_sensitively_change',
                'i.q1_react_sensitively_what_do',
                'i.q1_react_sensitively_what_do_status',
                'i.q2_enjoy_music',
                'i.q2_enjoy_music_change',
                'i.q2_enjoy_music_what_do',
                'i.q2_enjoy_music_what_do_status',
                'i.q3_ignore_call',
                'i.q3_ignore_call_change',
                'i.q3_ignore_call_what_do',
                'i.q3_ignore_call_what_do_status',
                'i.q4_ignore_tune_out',
                'i.q4_ignore_tune_out_change',
                'i.q4_ignore_tune_out_what_do',
                'i.q4_ignore_tune_out_what_do_status',
                'i.q5_notive_sounds',
                'i.q5_notive_sounds_change',
                'i.q5_notive_sounds_what_do',
                'i.q5_notive_sounds_what_do_status',
                'i.q6_show_distress_loud',
                'i.q6_show_distress_loud_change',
                'i.q6_show_distress_loud_what_do',
                'i.q6_show_distress_loud_what_do_status',
                'i.q7_enjoy_picture_books',
                'i.q7_enjoy_picture_books_change',
                'i.q7_enjoy_picture_books_what_do',
                'i.q7_enjoy_picture_books_what_do_status',
                'i.q8_disturbed_by_light',
                'i.q8_disturbed_by_light_change',
                'i.q8_disturbed_by_light_what_do',
                'i.q8_disturbed_by_light_what_do_status',
                'i.q9_stare_at_lights',
                'i.q9_stare_at_lights_change',
                'i.q9_stare_at_lights_what_do',
                'i.q9_stare_at_lights_what_do_status',
                'i.q10_slow_to_notice',
                'i.q10_slow_to_notice_change',
                'i.q10_slow_to_notice_what_do',
                'i.q10_slow_to_notice_what_do_status',
                'i.q11_avoid_looking',
                'i.q11_avoid_looking_change',
                'i.q11_avoid_looking_what_do',
                'i.q11_avoid_looking_what_do_status',
                'i.q12_seem_to_ignore',
                'i.q12_seem_to_ignore_change',
                'i.q12_seem_to_ignore_what_do',
                'i.q12_seem_to_ignore_what_do_status',
                'i.q13_enjoy_watching_videos',
                'i.q13_enjoy_watching_videos_change',
                'i.q13_enjoy_watching_videos_what_do',
                'i.q13_enjoy_watching_videos_what_do_status',
                'i.q14_dislike_cuddling',
                'i.q14_dislike_cuddling_change',
                'i.q14_dislike_cuddling_what_do',
                'i.q14_dislike_cuddling_what_do_status',
                'i.q15_show_distress_grooming',
                'i.q15_show_distress_grooming_change',
                'i.q15_show_distress_grooming_what_do',
                'i.q15_show_distress_grooming_what_do_status',
                'i.q16_avoid_touching',
                'i.q16_avoid_touching_change',
                'i.q16_avoid_touching_what_do',
                'i.q16_avoid_touching_what_do_status',
                'i.q17_react_negatively',
                'i.q17_react_negatively_change',
                'i.q17_react_negatively_what_do',
                'i.q17_react_negatively_what_do_status',
                'i.q18_trouble_adjusting',
                'i.q18_trouble_adjusting_change',
                'i.q18_trouble_adjusting_what_do',
                'i.q18_trouble_adjusting_what_do_status',
                'i.q19_slow_to_react',
                'i.q19_slow_to_react_change',
                'i.q19_slow_to_react_what_do',
                'i.q19_slow_to_react_what_do_status',
                'i.q20_dislike_tickled',
                'i.q20_dislike_tickled_change',
                'i.q20_dislike_tickled_what_do',
                'i.q20_dislike_tickled_what_do_status',
                'i.q21_ignore_tap',
                'i.q21_ignore_tap_change',
                'i.q21_ignore_tap_what_do',
                'i.q21_ignore_tap_what_do_status',
                'i.q22_refuse_new_foods',
                'i.q22_refuse_new_foods_change',
                'i.q22_refuse_new_foods_what_do',
                'i.q22_refuse_new_foods_what_do_status',
                'i.q23_smell_objects',
                'i.q23_smell_objects_change',
                'i.q23_smell_objects_what_do',
                'i.q23_smell_objects_what_do_status',
                'i.q24_interested_smell',
                'i.q24_interested_smell_change',
                'i.q24_interested_smell_what_do',
                'i.q24_interested_smell_what_do_status',
                'i.q25_put_objects',
                'i.q25_put_objects_change',
                'i.q25_put_objects_what_do',
                'i.q25_put_objects_what_do_status',
                'i.q26_enjoy_riding',
                'i.q26_enjoy_riding_change',
                'i.q26_enjoy_riding_what_do',
                'i.q26_enjoy_riding_what_do_status',
                'i.q27_like_jump',
                'i.q27_like_jump_change',
                'i.q27_like_jump_what_do',
                'i.q27_like_jump_what_do_status',
                'i.q28_seek_physical',
                'i.q28_seek_physical_change',
                'i.q28_seek_physical_what_do',
                'i.q28_seek_physical_what_do_status',
                'i.q29_uneasy_dizzy',
                'i.q29_uneasy_dizzy_change',
                'i.q29_uneasy_dizzy_what_do',
                'i.q29_uneasy_dizzy_what_do_status',
                'i.q30_flap_arms',
                'i.q30_flap_arms_change',
                'i.q30_flap_arms_what_do',
                'i.q30_flap_arms_what_do_status',
                'i.q31_free_time',
                'i.q31_free_time_status',
                'i.q32_seem_happiest',
                'i.q32_seem_happiest_status',
                'i.q33_enjoy_interaction',
                'i.q33_enjoy_interaction_status',
                'i.q34_works_best',
                'i.q34_works_best_status',
                'i.q35_other_comments',
                'i.q35_other_comments_status',
                'i.q36_a_sounds',
                'i.q36_b_lights',
                'i.q36_c_smells',
                'i.q36_d_tastes',
                'i.q36_e_textures',
                'i.q36_f_touch',
                'i.q37_seek_or_crave',
                'i.q37_seek_or_crave_status',
                'i.q38_pick_eater',
                'i.q38_selective',
                'i.q39_favourite_food_qualities',
                'i.q39_favourite_food_qualities_status',
                'i.q40_why_foods',
                'i.q40_why_foods_status',
                'i.q41_a_sounds',
                'i.q41_b_lights',
                'i.q41_c_smells',
                'i.q41_d_tastes',
                'i.q41_e_textures',
                'i.q41_f_touch',
                'i.q42_sensory_change',
                'i.q42_sensory_change_how',
                'i.q42_sensory_change_how_status',
                'i.q43_notice_change',
                'i.q43_notice_change_status'
            );
        } else if($this->instrument == 'm_chat_proband') {
            $fields = array(
                'i.total_item_fails',
                'i.total_critical_fails',
                'i.score',
                'i.q1_swung_on_knee',
                'i.q2_interest_other_children',
                'i.q3_climbing',
                'i.q4_peek_a_boo',
                'i.q5_pretends',
                'i.q6_index_point',
                'i.q7_index_interest',
                'i.q8_play_properly',
                'i.q9_bring_objects',
                'i.q10_look_eye',
                'i.q11_oversensitive',
                'i.q12_smile_to_face',
                'i.q13_imitate_you',
                'i.q14_respond_to_name',
                'i.q15_point_and_look',
                'i.q16_walk',
                'i.q17_look_at_similar',
                'i.q18_unusual_finger',
                'i.q19_try_to_attract',
                'i.q20_wondered_deaf',
                'i.q21_understand_speach',
                'i.q22_stare_no_purpose',
                'i.q23_look_at_face'
            );
        } else if($this->instrument == 'mullen') {
            $fields = array('i.other_comments',
            'i.expressive_lang_1',
            'i.expressive_lang_2',
            'i.expressive_lang_3',
            'i.expressive_lang_4',
            'i.expressive_lang_5',
            'i.expressive_lang_6',
            'i.expressive_lang_7',
            'i.expressive_lang_8',
            'i.expressive_lang_9',
            'i.expressive_lang_10',
            'i.expressive_lang_11',
            'i.expressive_lang_12',
            'i.expressive_lang_13',
            'i.expressive_lang_14',
            'i.expressive_lang_15',
            'i.expressive_lang_16',
            'i.expressive_lang_17',
            'i.expressive_lang_18',
            'i.expressive_lang_19',
            'i.expressive_lang_20',
            'i.expressive_lang_21',
            'i.expressive_lang_22',
            'i.expressive_lang_23',
            'i.expressive_lang_24',
            'i.expressive_lang_25',
            'i.expressive_lang_26',
            'i.expressive_lang_27',
            'i.expressive_lang_28',
            'i.expressive_language_raw',
            'i.expressive_language_t',
            'i.expressive_language_percentile',
            'i.expressive_language_description',
            'i.expressive_language_age_equivalent',
            'i.cognitive_t_score_sum',
            'i.composite_standard_score',
            'i.composite_percentile',
            'i.composite_description',
            'i.gross_motor_1',
            'i.gross_motor_2',
            'i.gross_motor_3',
            'i.gross_motor_4',
            'i.gross_motor_5',
            'i.gross_motor_6',
            'i.gross_motor_7',
            'i.gross_motor_8',
            'i.gross_motor_9',
            'i.gross_motor_10',
            'i.gross_motor_11',
            'i.gross_motor_12',
            'i.gross_motor_13',
            'i.gross_motor_14',
            'i.gross_motor_15',
            'i.gross_motor_16',
            'i.gross_motor_17',
            'i.gross_motor_18',
            'i.gross_motor_19',
            'i.gross_motor_20',
            'i.gross_motor_21',
            'i.gross_motor_22',
            'i.gross_motor_23',
            'i.gross_motor_24',
            'i.gross_motor_25',
            'i.gross_motor_26',
            'i.gross_motor_27',
            'i.gross_motor_28',
            'i.gross_motor_29',
            'i.gross_motor_30',
            'i.gross_motor_31',
            'i.gross_motor_32',
            'i.gross_motor_33',
            'i.gross_motor_34',
            'i.gross_motor_35',
            'i.gross_motor_raw',
            'i.gross_motor_t',
            'i.gross_motor_percentile',
            'i.gross_motor_description',
            'i.gross_motor_age_equivalent',
            'i.visual_recept_1',
            'i.visual_recept_2',
            'i.visual_recept_3',
            'i.visual_recept_4',
            'i.visual_recept_5',
            'i.visual_recept_6',
            'i.visual_recept_7',
            'i.visual_recept_8',
            'i.visual_recept_9',
            'i.visual_recept_10',
            'i.visual_recept_11',
            'i.visual_recept_12',
            'i.visual_recept_13',
            'i.visual_recept_14',
            'i.visual_recept_15',
            'i.visual_recept_16',
            'i.visual_recept_17',
            'i.visual_recept_18',
            'i.visual_recept_19',
            'i.visual_recept_20',
            'i.visual_recept_21',
            'i.visual_recept_22',
            'i.visual_recept_23',
            'i.visual_recept_24',
            'i.visual_recept_25',
            'i.visual_recept_26',
            'i.visual_recept_27',
            'i.visual_recept_28',
            'i.visual_recept_29',
            'i.visual_recept_30',
            'i.visual_recept_31',
            'i.visual_recept_32',
            'i.visual_recept_33',
            'i.visual_reception_raw',
            'i.visual_reception_t',
            'i.visual_reception_percentile',
            'i.visual_reception_description',
            'i.visual_reception_age_equivalent',
            'i.fine_motor_1',
            'i.fine_motor_2',
            'i.fine_motor_3',
            'i.fine_motor_4',
            'i.fine_motor_5',
            'i.fine_motor_6',
            'i.fine_motor_7',
            'i.fine_motor_8',
            'i.fine_motor_9',
            'i.fine_motor_10',
            'i.fine_motor_11',
            'i.fine_motor_12',
            'i.fine_motor_13',
            'i.fine_motor_14',
            'i.fine_motor_15',
            'i.fine_motor_16',
            'i.fine_motor_17',
            'i.fine_motor_18',
            'i.fine_motor_19',
            'i.fine_motor_20',
            'i.fine_motor_21',
            'i.fine_motor_22',
            'i.fine_motor_23',
            'i.fine_motor_24',
            'i.fine_motor_25',
            'i.fine_motor_26',
            'i.fine_motor_27',
            'i.fine_motor_28',
            'i.fine_motor_29',
            'i.fine_motor_30',
            'i.fine_motor_raw',
            'i.fine_motor_t',
            'i.fine_motor_percentile',
            'i.fine_motor_description',
            'i.fine_motor_age_equivalent',
            'i.receptive_lang_1',
            'i.receptive_lang_2',
            'i.receptive_lang_3',
            'i.receptive_lang_4',
            'i.receptive_lang_5',
            'i.receptive_lang_6',
            'i.receptive_lang_7',
            'i.receptive_lang_8',
            'i.receptive_lang_9',
            'i.receptive_lang_10',
            'i.receptive_lang_11',
            'i.receptive_lang_12',
            'i.receptive_lang_13',
            'i.receptive_lang_14',
            'i.receptive_lang_15',
            'i.receptive_lang_16',
            'i.receptive_lang_17',
            'i.receptive_lang_18',
            'i.receptive_lang_19',
            'i.receptive_lang_20',
            'i.receptive_lang_21',
            'i.receptive_lang_22',
            'i.receptive_lang_23',
            'i.receptive_lang_24',
            'i.receptive_lang_25',
            'i.receptive_lang_26',
            'i.receptive_lang_27',
            'i.receptive_lang_28',
            'i.receptive_lang_29',
            'i.receptive_lang_30',
            'i.receptive_lang_31',
            'i.receptive_lang_32',
            'i.receptive_lang_33',
            'i.receptive_language_raw',
            'i.receptive_language_t',
            'i.receptive_language_percentile',
            'i.receptive_language_description',
            'i.receptive_language_age_equivalent'
        );
        } else if($this->instrument == 'scq_proband' || $this->instrument == 'scq_subject') {
            $fields = array('i.score', 'i.q1_talk_short_phrases', 'i.q2_to_and_fro', 'i.q3_odd_phrases', 'i.q4_socially_inappropriate', 'i.q5_pronouns_mixed', 'i.q6_words_invented', 'i.q7_said_same_thing', 'i.q8_particular_way', 'i.q9_facial_expressions', 'i.q10_hand_like_tool', 'i.q11_interests_that_preoccupy', 'i.q12_interested_in_parts', 'i.q13_intense_interests', 'i.q14_sight_feel_sound', 'i.q15_mannerisms', 'i.q16_complicated_movements', 'i.q17_deliberate_injury', 'i.q18_carry_objects', 'i.q19_particular_friends', 'i.q20_talk_friendly', 'i.q21_spontaneously_copy', 'i.q22_spontaneously_point', 'i.q23_gestures', 'i.q24_nod_yes', 'i.q25_shake_no', 'i.q26_look_directly', 'i.q27_smile_back', 'i.q28_show_things', 'i.q29_offer_share', 'i.q30_join_enjoyment', 'i.q31_comfort', 'i.q32_wanted_something', 'i.q33_facial_expressions', 'i.q34_spontaneously_join', 'i.q35_play_pretend', 'i.q36_seem_interested', 'i.q37_respond_positively', 'i.q38_came_into_room', 'i.q39_play_imaginative', 'i.q40_play_cooperatively');
        } else if ($this->instrument == 'vineland_subject' || $this->instrument == 'vineland_proband') {
            $fields = array(
                'i.RELATIONSHIP',
                'i.SEX',
                'i.DIAGNOSIS',
                'i.`ABC_%ILE_RANK` as ABC_PERCENTILE_RANK',
                'i.`ABC_95%_CI` as ABC_95PERCENT_CI',
                'i.ABC_ADAPT_LEVEL',
                'i.ABC_STANINE',
                'i.ABC_STD_SCORE',
                'i.ABC_SUM_ALL_DOM_STD_SCORES',
                'i.`CMM_95%_CI` AS CMM_95PERCENT_CI',
                'i.CMM_ADAPT_LEVEL',
                'i.CMM_AGE_EQUIV',
                'i.CMM_ITEM_1_NDAR',
                'i.CMM_ITEM_2_NDAR',
                'i.CMM_ITEM_3_NDAR',
                'i.CMM_ITEM_4_NDAR',
                'i.CMM_ITEM_5_NDAR',
                'i.CMM_ITEM_6_NDAR',
                'i.CMM_ITEM_7_NDAR',
                'i.CMM_ITEM_8_NDAR',
                'i.CMM_ITEM_9_NDAR',
                'i.CMM_ITEM_10_NDAR',
                'i.CMM_ITEM_11_NDAR',
                'i.CMM_ITEM_12_NDAR',
                'i.CMM_ITEM_13_NDAR',
                'i.CMM_ITEM_14_NDAR',
                'i.CMM_ITEM_15_NDAR',
                'i.CMM_ITEM_16_NDAR',
                'i.CMM_ITEM_17_NDAR',
                'i.CMM_ITEM_18_NDAR',
                'i.CMM_ITEM_19_NDAR',
                'i.CMM_ITEM_20_NDAR',
                'i.CMM_ITEM_21_NDAR',
                'i.CMM_ITEM_22_NDAR',
                'i.CMM_ITEM_23_NDAR',
                'i.CMM_ITEM_24_NDAR',
                'i.CMM_ITEM_25_NDAR',
                'i.CMM_ITEM_26_NDAR',
                'i.CMM_ITEM_27_NDAR',
                'i.CMM_ITEM_28_NDAR',
                'i.CMM_ITEM_29_NDAR',
                'i.CMM_ITEM_30_NDAR',
                'i.CMM_ITEM_31_NDAR',
                'i.CMM_ITEM_32_NDAR',
                'i.CMM_ITEM_33_NDAR',
                'i.CMM_ITEM_34_NDAR',
                'i.CMM_ITEM_35_NDAR',
                'i.CMM_ITEM_36_NDAR',
                'i.CMM_ITEM_37_NDAR',
                'i.CMM_ITEM_38_NDAR',
                'i.CMM_ITEM_39_NDAR',
                'i.CMM_ITEM_40_NDAR',
                'i.CMM_ITEM_41_NDAR',
                'i.CMM_ITEM_42_NDAR',
                'i.CMM_ITEM_43_NDAR',
                'i.CMM_ITEM_44_NDAR',
                'i.CMM_RAW',
                'i.CMM_SW',
                'i.CMM_VSCALE',
                'i.`COM_%ILE_RANK` as COM_PERCENTILE_RANK',
                'i.`COM_95%_CI` as COM_95PERCENT_CI',
                'i.COM_ADAPT_LEVEL',
                'i.COM_STANINE',
                'i.COM_STD_SCORE',
                'i.COM_SUM_VSCALES_FOR_DOMAIN',
                'i.COM_SW',
                'i.CRIT_ITEM_1',
                'i.CRIT_ITEM_2',
                'i.CRIT_ITEM_3',
                'i.CRIT_ITEM_4',
                'i.CRIT_ITEM_5',
                'i.CRIT_ITEM_6',
                'i.CRIT_ITEM_7',
                'i.CRIT_ITEM_8',
                'i.CRIT_ITEM_9',
                'i.CRIT_ITEM_10',
                'i.CRIT_ITEM_11',
                'i.CRIT_ITEM_12',
                'i.CRIT_ITEM_13',
                'i.CRIT_ITEM_14',
                'i.CRIT_SEVERITY_ITEM_1',
                'i.CRIT_SEVERITY_ITEM_2',
                'i.CRIT_SEVERITY_ITEM_3',
                'i.CRIT_SEVERITY_ITEM_4',
                'i.CRIT_SEVERITY_ITEM_5',
                'i.CRIT_SEVERITY_ITEM_6',
                'i.CRIT_SEVERITY_ITEM_7',
                'i.CRIT_SEVERITY_ITEM_8',
                'i.CRIT_SEVERITY_ITEM_9',
                'i.`CS_95%_CI` as CS_95PERCENT_CI',
                'i.CRIT_SEVERITY_ITEM_10',
                'i.CRIT_SEVERITY_ITEM_11',
                'i.CRIT_SEVERITY_ITEM_12',
                'i.CRIT_SEVERITY_ITEM_13',
                'i.CRIT_SEVERITY_ITEM_14',
                'i.CS_ADAPT_LEVEL',
                'i.CS_AGE_EQUIV',
                'i.CS_ITEM_1_NDAR',
                'i.CS_ITEM_2_NDAR',
                'i.CS_ITEM_3_NDAR',
                'i.CS_ITEM_4_NDAR',
                'i.CS_ITEM_5_NDAR',
                'i.CS_ITEM_6_NDAR',
                'i.CS_ITEM_7_NDAR',
                'i.CS_ITEM_8_NDAR',
                'i.CS_ITEM_9_NDAR',
                'i.CS_ITEM_10_NDAR',
                'i.CS_ITEM_11_NDAR',
                'i.CS_ITEM_12_NDAR',
                'i.CS_ITEM_13_NDAR',
                'i.CS_ITEM_14_NDAR',
                'i.CS_ITEM_15_NDAR',
                'i.CS_ITEM_16_NDAR',
                'i.CS_ITEM_17_NDAR',
                'i.CS_ITEM_18_NDAR',
                'i.CS_ITEM_19_NDAR',
                'i.CS_ITEM_20_NDAR',
                'i.CS_ITEM_21_NDAR',
                'i.CS_ITEM_22_NDAR',
                'i.CS_ITEM_23_NDAR',
                'i.CS_ITEM_24_NDAR',
                'i.CS_ITEM_25_NDAR',
                'i.CS_ITEM_26_NDAR',
                'i.CS_ITEM_27_NDAR',
                'i.CS_ITEM_28_NDAR',
                'i.CS_ITEM_29_NDAR',
                'i.CS_ITEM_30_NDAR',
                'i.CS_RAW',
                'i.CS_SW',
                'i.CS_VSCALE',
                'i.`DLS_%ILE_RANK` as DLS_PERCENTILE_RANK',
                'i.`DLS_95%_CI` as DLS_95PERCENT_CI',
                'i.DLS_ADAPT_LEVEL',
                'i.DLS_STANINE',
                'i.DLS_STD_SCORE',
                'i.DLS_SUM_VSCALES_FOR_DOMAIN',
                'i.DLS_SW',
                'i.`DOM_95%_CI` as DOM_95PERCENT_CI',
                'i.DOM_ADAPT_LEVEL',
                'i.DOM_AGE_EQUIV',
                'i.DOM_ITEM_1_NDAR',
                'i.DOM_ITEM_2_NDAR',
                'i.DOM_ITEM_3_NDAR',
                'i.DOM_ITEM_4_NDAR',
                'i.DOM_ITEM_5_NDAR',
                'i.DOM_ITEM_6_NDAR',
                'i.DOM_ITEM_7_NDAR',
                'i.DOM_ITEM_8_NDAR',
                'i.DOM_ITEM_9_NDAR',
                'i.DOM_ITEM_10_NDAR',
                'i.DOM_ITEM_11_NDAR',
                'i.DOM_ITEM_12_NDAR',
                'i.DOM_ITEM_13_NDAR',
                'i.DOM_ITEM_14_NDAR',
                'i.DOM_ITEM_15_NDAR',
                'i.DOM_ITEM_16_NDAR',
                'i.DOM_ITEM_17_NDAR',
                'i.DOM_ITEM_18_NDAR',
                'i.DOM_ITEM_19_NDAR',
                'i.DOM_ITEM_20_NDAR',
                'i.DOM_ITEM_21_NDAR',
                'i.DOM_ITEM_22_NDAR',
                'i.DOM_ITEM_23_NDAR',
                'i.DOM_ITEM_24_NDAR',
                'i.DOM_RAW',
                'i.DOM_SW',
                'i.DOM_VSCALE',
                'i.`EXP_95%_CI` AS EXP_95PERCENT_CI',
                'i.EXP_ADAPT_LEVEL',
                'i.EXP_AGE_EQUIV',
                'i.EXP_ITEM_1_NDAR',
                'i.EXP_ITEM_2_NDAR',
                'i.EXP_ITEM_3_NDAR',
                'i.EXP_ITEM_4_NDAR',
                'i.EXP_ITEM_5_NDAR',
                'i.EXP_ITEM_6_NDAR',
                'i.EXP_ITEM_7_NDAR',
                'i.EXP_ITEM_8_NDAR',
                'i.EXP_ITEM_9_NDAR',
                'i.EXP_ITEM_10_NDAR',
                'i.EXP_ITEM_11_NDAR',
                'i.EXP_ITEM_12_NDAR',
                'i.EXP_ITEM_13_NDAR',
                'i.EXP_ITEM_14_NDAR',
                'i.EXP_ITEM_15_NDAR',
                'i.EXP_ITEM_16_NDAR',
                'i.EXP_ITEM_17_NDAR',
                'i.EXP_ITEM_18_NDAR',
                'i.EXP_ITEM_19_NDAR',
                'i.EXP_ITEM_20_NDAR',
                'i.EXP_ITEM_21_NDAR',
                'i.EXP_ITEM_22_NDAR',
                'i.EXP_ITEM_23_NDAR',
                'i.EXP_ITEM_24_NDAR',
                'i.EXP_ITEM_25_NDAR',
                'i.EXP_ITEM_26_NDAR',
                'i.EXP_ITEM_27_NDAR',
                'i.EXP_ITEM_28_NDAR',
                'i.EXP_ITEM_29_NDAR',
                'i.EXP_ITEM_30_NDAR',
                'i.EXP_ITEM_31_NDAR',
                'i.EXP_ITEM_32_NDAR',
                'i.EXP_ITEM_33_NDAR',
                'i.EXP_ITEM_34_NDAR',
                'i.EXP_ITEM_35_NDAR',
                'i.EXP_ITEM_36_NDAR',
                'i.EXP_ITEM_37_NDAR',
                'i.EXP_ITEM_38_NDAR',
                'i.EXP_ITEM_39_NDAR',
                'i.EXP_ITEM_40_NDAR',
                'i.EXP_ITEM_41_NDAR',
                'i.EXP_ITEM_42_NDAR',
                'i.EXP_ITEM_43_NDAR',
                'i.EXP_ITEM_44_NDAR',
                'i.EXP_ITEM_45_NDAR',
                'i.EXP_ITEM_46_NDAR',
                'i.EXP_ITEM_47_NDAR',
                'i.EXP_ITEM_48_NDAR',
                'i.EXP_ITEM_49_NDAR',
                'i.EXP_ITEM_50_NDAR',
                'i.EXP_ITEM_51_NDAR',
                'i.EXP_ITEM_52_NDAR',
                'i.EXP_ITEM_53_NDAR',
                'i.EXP_ITEM_54_NDAR',
                'i.EXP_RAW',
                'i.EXP_SW',
                'i.EXP_VSCALE',
                'i.`EXT_95%_CI` AS EXT_95PERCENT_CI',
                'i.EXT_ADAPT_LEVEL',
                'i.EXT_ITEM_1_NDAR',
                'i.EXT_ITEM_2_NDAR',
                'i.EXT_ITEM_3_NDAR',
                'i.EXT_ITEM_4_NDAR',
                'i.EXT_ITEM_5_NDAR',
                'i.EXT_ITEM_6_NDAR',
                'i.EXT_ITEM_7_NDAR',
                'i.EXT_ITEM_8_NDAR',
                'i.EXT_ITEM_9_NDAR',
                'i.EXT_ITEM_10_NDAR',
                'i.EXT_RAW',
                'i.EXT_VSCALE',
                'i.`FMS_95%_CI` AS FMS_95PERCENT_CI',
                'i.FMS_ADAPT_LEVEL',
                'i.FMS_AGE_EQUIV',
                'i.FMS_ITEM_1_NDAR',
                'i.FMS_ITEM_2_NDAR',
                'i.FMS_ITEM_3_NDAR',
                'i.FMS_ITEM_4_NDAR',
                'i.FMS_ITEM_5_NDAR',
                'i.FMS_ITEM_6_NDAR',
                'i.FMS_ITEM_7_NDAR',
                'i.FMS_ITEM_8_NDAR',
                'i.FMS_ITEM_9_NDAR',
                'i.FMS_ITEM_10_NDAR',
                'i.FMS_ITEM_11_NDAR',
                'i.FMS_ITEM_12_NDAR',
                'i.FMS_ITEM_13_NDAR',
                'i.FMS_ITEM_14_NDAR',
                'i.FMS_ITEM_15_NDAR',
                'i.FMS_ITEM_16_NDAR',
                'i.FMS_ITEM_17_NDAR',
                'i.FMS_ITEM_18_NDAR',
                'i.FMS_ITEM_19_NDAR',
                'i.FMS_ITEM_20_NDAR',
                'i.FMS_ITEM_21_NDAR',
                'i.FMS_ITEM_22_NDAR',
                'i.FMS_ITEM_23_NDAR',
                'i.FMS_ITEM_24_NDAR',
                'i.FMS_ITEM_25_NDAR',
                'i.FMS_ITEM_26_NDAR',
                'i.FMS_ITEM_27_NDAR',
                'i.FMS_ITEM_28_NDAR',
                'i.FMS_ITEM_29_NDAR',
                'i.FMS_ITEM_30_NDAR',
                'i.FMS_ITEM_31_NDAR',
                'i.FMS_ITEM_32_NDAR',
                'i.FMS_ITEM_33_NDAR',
                'i.FMS_ITEM_34_NDAR',
                'i.FMS_ITEM_35_NDAR',
                'i.FMS_ITEM_36_NDAR',
                'i.FMS_RAW',
                'i.FMS_SW',
                'i.FMS_VSCALE',
                'i.`GMS_95%_CI` as GMS_95PERCENT_CI',
                'i.GMS_ADAPT_LEVEL',
                'i.GMS_AGE_EQUIV',
                'i.GMS_ITEM_1_NDAR',
                'i.GMS_ITEM_2_NDAR',
                'i.GMS_ITEM_3_NDAR',
                'i.GMS_ITEM_4_NDAR',
                'i.GMS_ITEM_5_NDAR',
                'i.GMS_ITEM_6_NDAR',
                'i.GMS_ITEM_7_NDAR',
                'i.GMS_ITEM_8_NDAR',
                'i.GMS_ITEM_9_NDAR',
                'i.GMS_ITEM_10_NDAR',
                'i.GMS_ITEM_11_NDAR',
                'i.GMS_ITEM_12_NDAR',
                'i.GMS_ITEM_13_NDAR',
                'i.GMS_ITEM_14_NDAR',
                'i.GMS_ITEM_15_NDAR',
                'i.GMS_ITEM_16_NDAR',
                'i.GMS_ITEM_17_NDAR',
                'i.GMS_ITEM_18_NDAR',
                'i.GMS_ITEM_19_NDAR',
                'i.GMS_ITEM_20_NDAR',
                'i.GMS_ITEM_21_NDAR',
                'i.GMS_ITEM_22_NDAR',
                'i.GMS_ITEM_23_NDAR',
                'i.GMS_ITEM_24_NDAR',
                'i.GMS_ITEM_25_NDAR',
                'i.GMS_ITEM_26_NDAR',
                'i.GMS_ITEM_27_NDAR',
                'i.GMS_ITEM_28_NDAR',
                'i.GMS_ITEM_29_NDAR',
                'i.GMS_ITEM_30_NDAR',
                'i.GMS_ITEM_31_NDAR',
                'i.GMS_ITEM_32_NDAR',
                'i.GMS_ITEM_33_NDAR',
                'i.GMS_ITEM_34_NDAR',
                'i.GMS_ITEM_35_NDAR',
                'i.GMS_ITEM_36_NDAR',
                'i.GMS_ITEM_37_NDAR',
                'i.GMS_ITEM_38_NDAR',
                'i.GMS_ITEM_39_NDAR',
                'i.GMS_ITEM_40_NDAR',
                'i.GMS_RAW',
                'i.GMS_SW',
                'i.GMS_VSCALE',
                'i.GRADE',
                'i.`INT_95%_CI` AS INT_95PERCENT_CI',
                'i.INT_ADAPT_LEVEL',
                'i.INT_ITEM_1_NDAR',
                'i.INT_ITEM_2_NDAR',
                'i.INT_ITEM_3_NDAR',
                'i.INT_ITEM_4_NDAR',
                'i.INT_ITEM_5_NDAR',
                'i.INT_ITEM_6_NDAR',
                'i.INT_ITEM_7_NDAR',
                'i.INT_ITEM_8_NDAR',
                'i.INT_ITEM_9_NDAR',
                'i.INT_ITEM_10_NDAR',
                'i.INT_ITEM_11_NDAR',
                'i.INT_RAW',
                'i.INT_VSCALE',
                'i.`IPR_95%_CI` AS IPR_95PERCENT_CI',
                'i.IPR_ADAPT_LEVEL',
                'i.IPR_AGE_EQUIV',
                'i.IPR_ITEM_1_NDAR',
                'i.IPR_ITEM_2_NDAR',
                'i.IPR_ITEM_3_NDAR',
                'i.IPR_ITEM_4_NDAR',
                'i.IPR_ITEM_5_NDAR',
                'i.IPR_ITEM_6_NDAR',
                'i.IPR_ITEM_7_NDAR',
                'i.IPR_ITEM_8_NDAR',
                'i.IPR_ITEM_9_NDAR',
                'i.IPR_ITEM_10_NDAR',
                'i.IPR_ITEM_11_NDAR',
                'i.IPR_ITEM_12_NDAR',
                'i.IPR_ITEM_13_NDAR',
                'i.IPR_ITEM_14_NDAR',
                'i.IPR_ITEM_15_NDAR',
                'i.IPR_ITEM_16_NDAR',
                'i.IPR_ITEM_17_NDAR',
                'i.IPR_ITEM_18_NDAR',
                'i.IPR_ITEM_19_NDAR',
                'i.IPR_ITEM_20_NDAR',
                'i.IPR_ITEM_21_NDAR',
                'i.IPR_ITEM_22_NDAR',
                'i.IPR_ITEM_23_NDAR',
                'i.IPR_ITEM_24_NDAR',
                'i.IPR_ITEM_25_NDAR',
                'i.IPR_ITEM_26_NDAR',
                'i.IPR_ITEM_27_NDAR',
                'i.IPR_ITEM_28_NDAR',
                'i.IPR_ITEM_29_NDAR',
                'i.IPR_ITEM_30_NDAR',
                'i.IPR_ITEM_31_NDAR',
                'i.IPR_ITEM_32_NDAR',
                'i.IPR_ITEM_33_NDAR',
                'i.IPR_ITEM_34_NDAR',
                'i.IPR_ITEM_35_NDAR',
                'i.IPR_ITEM_36_NDAR',
                'i.IPR_ITEM_37_NDAR',
                'i.IPR_ITEM_38_NDAR',
                'i.IPR_RAW',
                'i.IPR_SW',
                'i.IPR_VSCALE',
                'i.`MBI_95%_CI` AS MBI_95PERCENT_CI',
                'i.MBI_ADAPT_LEVEL',
                'i.MBI_RAW',
                'i.MBI_VSCALE',
                'i.`MS_%ILE_RANK` AS MS_PERCENTILE_RANK',
                'i.`MS_95%_CI` AS MS_95PERCENT_CI',
                'i.MS_ADAPT_LEVEL',
                'i.MS_STANINE',
                'i.MS_STD_SCORE',
                'i.MS_SUM_VSCALES_FOR_DOMAIN',
                'i.MS_SW',
                'i.OTH_ITEM_1_NDAR',
                'i.OTH_ITEM_2_NDAR',
                'i.OTH_ITEM_3_NDAR',
                'i.OTH_ITEM_4_NDAR',
                'i.OTH_ITEM_5_NDAR',
                'i.OTH_ITEM_6_NDAR',
                'i.OTH_ITEM_7_NDAR',
                'i.OTH_ITEM_8_NDAR',
                'i.OTH_ITEM_9_NDAR',
                'i.OTH_ITEM_10_NDAR',
                'i.OTH_ITEM_11_NDAR',
                'i.OTH_ITEM_12_NDAR',
                'i.OTH_ITEM_13_NDAR',
                'i.OTH_ITEM_14_NDAR',
                'i.OTH_ITEM_15_NDAR',
                'i.`PER_95%_CI` AS PER_95PERCENT_CI',
                'i.PER_ADAPT_LEVEL',
                'i.PER_AGE_EQUIV',
                'i.PER_ITEM_1_NDAR',
                'i.PER_ITEM_2_NDAR',
                'i.PER_ITEM_3_NDAR',
                'i.PER_ITEM_4_NDAR',
                'i.PER_ITEM_5_NDAR',
                'i.PER_ITEM_6_NDAR',
                'i.PER_ITEM_7_NDAR',
                'i.PER_ITEM_8_NDAR',
                'i.PER_ITEM_9_NDAR',
                'i.PER_ITEM_10_NDAR',
                'i.PER_ITEM_11_NDAR',
                'i.PER_ITEM_12_NDAR',
                'i.PER_ITEM_13_NDAR',
                'i.PER_ITEM_14_NDAR',
                'i.PER_ITEM_15_NDAR',
                'i.PER_ITEM_16_NDAR',
                'i.PER_ITEM_17_NDAR',
                'i.PER_ITEM_18_NDAR',
                'i.PER_ITEM_19_NDAR',
                'i.PER_ITEM_20_NDAR',
                'i.PER_ITEM_21_NDAR',
                'i.PER_ITEM_22_NDAR',
                'i.PER_ITEM_23_NDAR',
                'i.PER_ITEM_24_NDAR',
                'i.PER_ITEM_25_NDAR',
                'i.PER_ITEM_26_NDAR',
                'i.PER_ITEM_27_NDAR',
                'i.PER_ITEM_28_NDAR',
                'i.PER_ITEM_29_NDAR',
                'i.PER_ITEM_30_NDAR',
                'i.PER_ITEM_31_NDAR',
                'i.PER_ITEM_32_NDAR',
                'i.PER_ITEM_33_NDAR',
                'i.PER_ITEM_34_NDAR',
                'i.PER_ITEM_35_NDAR',
                'i.PER_ITEM_36_NDAR',
                'i.PER_ITEM_37_NDAR',
                'i.PER_ITEM_38_NDAR',
                'i.PER_ITEM_39_NDAR',
                'i.PER_ITEM_40_NDAR',
                'i.PER_ITEM_41_NDAR',
                'i.PER_RAW',
                'i.PER_SW',
                'i.PER_VSCALE',
                'i.`PL_95%_CI` AS PL_95PERCENT_CI',
                'i.PL_ADAPT_LEVEL',
                'i.PL_AGE_EQUIV',
                'i.PL_ITEM_1_NDAR',
                'i.PL_ITEM_2_NDAR',
                'i.PL_ITEM_3_NDAR',
                'i.PL_ITEM_4_NDAR',
                'i.PL_ITEM_5_NDAR',
                'i.PL_ITEM_6_NDAR',
                'i.PL_ITEM_7_NDAR',
                'i.PL_ITEM_8_NDAR',
                'i.PL_ITEM_9_NDAR',
                'i.PL_ITEM_10_NDAR',
                'i.PL_ITEM_11_NDAR',
                'i.PL_ITEM_12_NDAR',
                'i.PL_ITEM_13_NDAR',
                'i.PL_ITEM_14_NDAR',
                'i.PL_ITEM_15_NDAR',
                'i.PL_ITEM_16_NDAR',
                'i.PL_ITEM_17_NDAR',
                'i.PL_ITEM_18_NDAR',
                'i.PL_ITEM_19_NDAR',
                'i.PL_ITEM_20_NDAR',
                'i.PL_ITEM_21_NDAR',
                'i.PL_ITEM_22_NDAR',
                'i.PL_ITEM_23_NDAR',
                'i.PL_ITEM_24_NDAR',
                'i.PL_ITEM_25_NDAR',
                'i.PL_ITEM_26_NDAR',
                'i.PL_ITEM_27_NDAR',
                'i.PL_ITEM_28_NDAR',
                'i.PL_ITEM_29_NDAR',
                'i.PL_ITEM_30_NDAR',
                'i.PL_ITEM_31_NDAR',
                'i.PL_RAW',
                'i.PL_SW',
                'i.PL_VSCALE',
                'i.`REC_95%_CI` AS REC_95PERCENT_CI',
                'i.REC_ADAPT_LEVEL',
                'i.REC_AGE_EQUIV',
                'i.REC_ITEM_1_NDAR',
                'i.REC_ITEM_2_NDAR',
                'i.REC_ITEM_3_NDAR',
                'i.REC_ITEM_4_NDAR',
                'i.REC_ITEM_5_NDAR',
                'i.REC_ITEM_6_NDAR',
                'i.REC_ITEM_7_NDAR',
                'i.REC_ITEM_8_NDAR',
                'i.REC_ITEM_9_NDAR',
                'i.REC_ITEM_10_NDAR',
                'i.REC_ITEM_11_NDAR',
                'i.REC_ITEM_12_NDAR',
                'i.REC_ITEM_13_NDAR',
                'i.REC_ITEM_14_NDAR',
                'i.REC_ITEM_15_NDAR',
                'i.REC_ITEM_16_NDAR',
                'i.REC_ITEM_17_NDAR',
                'i.REC_ITEM_18_NDAR',
                'i.REC_ITEM_19_NDAR',
                'i.REC_ITEM_20_NDAR',
                'i.REC_RAW',
                'i.REC_SW',
                'i.REC_VSCALE',
                'i.`SOC_%ILE_RANK` AS SOC_PERCENTILE_RANK',
                'i.`SOC_95%_CI` as SOC_95PERCENT_CI',
                'i.SOC_ADAPT_LEVEL',
                'i.SOC_STANINE',
                'i.SOC_STD_SCORE',
                'i.SOC_SUM_VSCALES_FOR_DOMAIN',
                'i.SOC_SW',
                'i.`WRN_95%_CI` AS WRN_95PERCENT_CI',
                'i.WRN_ADAPT_LEVEL',
                'i.WRN_AGE_EQUIV',
                'i.WRN_ITEM_1_NDAR',
                'i.WRN_ITEM_2_NDAR',
                'i.WRN_ITEM_3_NDAR',
                'i.WRN_ITEM_4_NDAR',
                'i.WRN_ITEM_5_NDAR',
                'i.WRN_ITEM_6_NDAR',
                'i.WRN_ITEM_7_NDAR',
                'i.WRN_ITEM_8_NDAR',
                'i.WRN_ITEM_9_NDAR',
                'i.WRN_ITEM_10_NDAR',
                'i.WRN_ITEM_11_NDAR',
                'i.WRN_ITEM_12_NDAR',
                'i.WRN_ITEM_13_NDAR',
                'i.WRN_ITEM_14_NDAR',
                'i.WRN_ITEM_15_NDAR',
                'i.WRN_ITEM_16_NDAR',
                'i.WRN_ITEM_17_NDAR',
                'i.WRN_ITEM_18_NDAR',
                'i.WRN_ITEM_19_NDAR',
                'i.WRN_ITEM_20_NDAR',
                'i.WRN_ITEM_21_NDAR',
                'i.WRN_ITEM_22_NDAR',
                'i.WRN_ITEM_23_NDAR',
                'i.WRN_ITEM_24_NDAR',
                'i.WRN_ITEM_25_NDAR',
                'i.WRN_RAW',
                'i.WRN_SW',
                'i.WRN_VSCALE');
        } else if($this->instrument == 'rbs_r') {
            $fields = array('i.Date_taken', 'i.Candidate_Age', 'i.respondent', 'i.respondent_specify', 'i.I_stereotyped_endorsed', 'i.I_stereotyped_score', 'i.II_self_injurious_endorsed', 'i.II_self_injurious_score', 'i.III_compulsive_endorsed', 'i.III_compulsive_score', 'i.IV_ritualistic_endorsed', 'i.IV_ritualistic_score', 'i.overall_endorsed', 'i.overall_score', 'i.q1_whole_body', 'i.q10_bites_self', 'i.q11_pulls', 'i.q12_rubs_or_scratches', 'i.q13_inserts_finger_or_object', 'i.q14_skin_picking', 'i.q15_arranging_ordering', 'i.q16_completeness', 'i.q17_washing_cleaning', 'i.q18_checking', 'i.q19_counting', 'i.q2_head', 'i.q20_hoarding_saving', 'i.q21_repeating', 'i.q22_touch_tap', 'i.q23_eating_mealtime', 'i.q24_sleeping_bedtime', 'i.q25_self_care', 'i.q26_travel_transportation', 'i.q27_play_leisure', 'i.q28_communication', 'i.q29_insists_things_remain', 'i.q3_hand_finger', 'i.q30_objects_to_visiting', 'i.q31_upset_if_interrupted', 'i.q32_walking_in_a_pattern', 'i.q33_insists_on_sitting_at_same_place', 'i.q34_dislikes_change', 'i.q35_insists_on_particular_door', 'i.q36_likes_same_cd', 'i.q37_resists_changing_activities', 'i.q38_insists_on_same_routine', 'i.q39_insists_that_specific', 'i.q4_locomotion', 'i.q40_fascination_preoccupation', 'i.q41_strongly_attached', 'i.q42_preoccupation_with_parts', 'i.q43_fascination_with_movement', 'i.q5_object_usage', 'i.q6_sensory', 'i.q7_hits_self_body_part', 'i.q8_hits_self_against_surface', 'i.q9_hits_self_with_object', 'i.V_sameness_endorsed', 'i.V_sameness_score', 'i.VI_restricted_endorsed', 'i.VI_restricted_score');
        } else if($this->instrument == 'macarthur_words_gestures') {
            $fields = array('i.Candidate_Age',
                'i.early_gestures_number',
                'i.early_gestures_percentile',
                'i.I_A_1',
                'i.I_A_2',
                'i.I_A_3',
                'i.I_B_1',
                'i.I_B_10',
                'i.I_B_11',
                'i.I_B_12',
                'i.I_B_13',
                'i.I_B_14',
                'i.I_B_15',
                'i.I_B_16',
                'i.I_B_17',
                'i.I_B_18',
                'i.I_B_19',
                'i.I_B_2',
                'i.I_B_20',
                'i.I_B_21',
                'i.I_B_22',
                'i.I_B_23',
                'i.I_B_24',
                'i.I_B_25',
                'i.I_B_26',
                'i.I_B_27',
                'i.I_B_28',
                'i.I_B_3',
                'i.I_B_4',
                'i.I_B_5',
                'i.I_B_6',
                'i.I_B_7',
                'i.I_B_8',
                'i.I_B_9',
                'i.I_C_1',
                'i.I_C_1_score',
                'i.I_C_2',
                'i.I_C_2_score',
                'i.I_D_1_1',
                'i.I_D_1_10',
                'i.I_D_1_11',
                'i.I_D_1_12',
                'i.I_D_1_2',
                'i.I_D_1_3',
                'i.I_D_1_4',
                'i.I_D_1_5',
                'i.I_D_1_6',
                'i.I_D_1_7',
                'i.I_D_1_8',
                'i.I_D_1_9',
                'i.I_D_10_1',
                'i.I_D_10_10',
                'i.I_D_10_11',
                'i.I_D_10_12',
                'i.I_D_10_13',
                'i.I_D_10_14',
                'i.I_D_10_15',
                'i.I_D_10_16',
                'i.I_D_10_17',
                'i.I_D_10_18',
                'i.I_D_10_19',
                'i.I_D_10_2',
                'i.I_D_10_20',
                'i.I_D_10_21',
                'i.I_D_10_22',
                'i.I_D_10_23',
                'i.I_D_10_24',
                'i.I_D_10_25',
                'i.I_D_10_26',
                'i.I_D_10_27',
                'i.I_D_10_3',
                'i.I_D_10_4',
                'i.I_D_10_5',
                'i.I_D_10_6',
                'i.I_D_10_7',
                'i.I_D_10_8',
                'i.I_D_10_9',
                'i.I_D_11_1',
                'i.I_D_11_10',
                'i.I_D_11_11',
                'i.I_D_11_12',
                'i.I_D_11_13',
                'i.I_D_11_14',
                'i.I_D_11_15',
                'i.I_D_11_16',
                'i.I_D_11_17',
                'i.I_D_11_18',
                'i.I_D_11_19',
                'i.I_D_11_2',
                'i.I_D_11_20',
                'i.I_D_11_3',
                'i.I_D_11_4',
                'i.I_D_11_5',
                'i.I_D_11_6',
                'i.I_D_11_7',
                'i.I_D_11_8',
                'i.I_D_11_9',
                'i.I_D_12_1',
                'i.I_D_12_10',
                'i.I_D_12_11',
                'i.I_D_12_12',
                'i.I_D_12_13',
                'i.I_D_12_14',
                'i.I_D_12_15',
                'i.I_D_12_16',
                'i.I_D_12_17',
                'i.I_D_12_18',
                'i.I_D_12_19',
                'i.I_D_12_2',
                'i.I_D_12_3',
                'i.I_D_12_4',
                'i.I_D_12_5',
                'i.I_D_12_6',
                'i.I_D_12_7',
                'i.I_D_12_8',
                'i.I_D_12_9',
                'i.I_D_13_1',
                'i.I_D_13_10',
                'i.I_D_13_11',
                'i.I_D_13_12',
                'i.I_D_13_13',
                'i.I_D_13_14',
                'i.I_D_13_15',
                'i.I_D_13_16',
                'i.I_D_13_17',
                'i.I_D_13_18',
                'i.I_D_13_19',
                'i.I_D_13_2',
                'i.I_D_13_20',
                'i.I_D_13_21',
                'i.I_D_13_22',
                'i.I_D_13_23',
                'i.I_D_13_24',
                'i.I_D_13_25',
                'i.I_D_13_26',
                'i.I_D_13_27',
                'i.I_D_13_28',
                'i.I_D_13_29',
                'i.I_D_13_3',
                'i.I_D_13_30',
                'i.I_D_13_31',
                'i.I_D_13_32',
                'i.I_D_13_33',
                'i.I_D_13_34',
                'i.I_D_13_35',
                'i.I_D_13_36',
                'i.I_D_13_37',
                'i.I_D_13_38',
                'i.I_D_13_39',
                'i.I_D_13_4',
                'i.I_D_13_40',
                'i.I_D_13_41',
                'i.I_D_13_42',
                'i.I_D_13_43',
                'i.I_D_13_44',
                'i.I_D_13_45',
                'i.I_D_13_46',
                'i.I_D_13_47',
                'i.I_D_13_48',
                'i.I_D_13_49',
                'i.I_D_13_5',
                'i.I_D_13_50',
                'i.I_D_13_51',
                'i.I_D_13_52',
                'i.I_D_13_53',
                'i.I_D_13_54',
                'i.I_D_13_55',
                'i.I_D_13_6',
                'i.I_D_13_7',
                'i.I_D_13_8',
                'i.I_D_13_9',
                'i.I_D_14_1',
                'i.I_D_14_2',
                'i.I_D_14_3',
                'i.I_D_14_4',
                'i.I_D_14_5',
                'i.I_D_14_6',
                'i.I_D_14_7',
                'i.I_D_14_8',
                'i.I_D_15_1',
                'i.I_D_15_10',
                'i.I_D_15_11',
                'i.I_D_15_12',
                'i.I_D_15_13',
                'i.I_D_15_14',
                'i.I_D_15_15',
                'i.I_D_15_16',
                'i.I_D_15_17',
                'i.I_D_15_18',
                'i.I_D_15_19',
                'i.I_D_15_2',
                'i.I_D_15_20',
                'i.I_D_15_21',
                'i.I_D_15_22',
                'i.I_D_15_23',
                'i.I_D_15_24',
                'i.I_D_15_25',
                'i.I_D_15_26',
                'i.I_D_15_27',
                'i.I_D_15_28',
                'i.I_D_15_29',
                'i.I_D_15_3',
                'i.I_D_15_30',
                'i.I_D_15_31',
                'i.I_D_15_32',
                'i.I_D_15_33',
                'i.I_D_15_34',
                'i.I_D_15_35',
                'i.I_D_15_36',
                'i.I_D_15_37',
                'i.I_D_15_4',
                'i.I_D_15_5',
                'i.I_D_15_6',
                'i.I_D_15_7',
                'i.I_D_15_8',
                'i.I_D_15_9',
                'i.I_D_16_1',
                'i.I_D_16_10',
                'i.I_D_16_11',
                'i.I_D_16_2',
                'i.I_D_16_3',
                'i.I_D_16_4',
                'i.I_D_16_5',
                'i.I_D_16_6',
                'i.I_D_16_7',
                'i.I_D_16_8',
                'i.I_D_16_9',
                'i.I_D_17_1',
                'i.I_D_17_2',
                'i.I_D_17_3',
                'i.I_D_17_4',
                'i.I_D_17_5',
                'i.I_D_17_6',
                'i.I_D_18_1',
                'i.I_D_18_10',
                'i.I_D_18_11',
                'i.I_D_18_2',
                'i.I_D_18_3',
                'i.I_D_18_4',
                'i.I_D_18_5',
                'i.I_D_18_6',
                'i.I_D_18_7',
                'i.I_D_18_8',
                'i.I_D_18_9',
                'i.I_D_19_1',
                'i.I_D_19_2',
                'i.I_D_19_3',
                'i.I_D_19_4',
                'i.I_D_19_5',
                'i.I_D_19_6',
                'i.I_D_19_7',
                'i.I_D_19_8',
                'i.I_D_2_1',
                'i.I_D_2_10',
                'i.I_D_2_11',
                'i.I_D_2_12',
                'i.I_D_2_13',
                'i.I_D_2_14',
                'i.I_D_2_15',
                'i.I_D_2_16',
                'i.I_D_2_17',
                'i.I_D_2_18',
                'i.I_D_2_19',
                'i.I_D_2_2',
                'i.I_D_2_20',
                'i.I_D_2_21',
                'i.I_D_2_22',
                'i.I_D_2_23',
                'i.I_D_2_24',
                'i.I_D_2_25',
                'i.I_D_2_26',
                'i.I_D_2_27',
                'i.I_D_2_28',
                'i.I_D_2_29',
                'i.I_D_2_3',
                'i.I_D_2_30',
                'i.I_D_2_31',
                'i.I_D_2_32',
                'i.I_D_2_33',
                'i.I_D_2_34',
                'i.I_D_2_35',
                'i.I_D_2_36',
                'i.I_D_2_4',
                'i.I_D_2_5',
                'i.I_D_2_6',
                'i.I_D_2_7',
                'i.I_D_2_8',
                'i.I_D_2_9',
                'i.I_D_3_1',
                'i.I_D_3_2',
                'i.I_D_3_3',
                'i.I_D_3_4',
                'i.I_D_3_5',
                'i.I_D_3_6',
                'i.I_D_3_7',
                'i.I_D_3_8',
                'i.I_D_3_9',
                'i.I_D_4_1',
                'i.I_D_4_2',
                'i.I_D_4_3',
                'i.I_D_4_4',
                'i.I_D_4_5',
                'i.I_D_4_6',
                'i.I_D_4_7',
                'i.I_D_4_8',
                'i.I_D_5_1',
                'i.I_D_5_10',
                'i.I_D_5_11',
                'i.I_D_5_12',
                'i.I_D_5_13',
                'i.I_D_5_14',
                'i.I_D_5_15',
                'i.I_D_5_16',
                'i.I_D_5_17',
                'i.I_D_5_18',
                'i.I_D_5_19',
                'i.I_D_5_2',
                'i.I_D_5_20',
                'i.I_D_5_21',
                'i.I_D_5_22',
                'i.I_D_5_23',
                'i.I_D_5_24',
                'i.I_D_5_25',
                'i.I_D_5_26',
                'i.I_D_5_27',
                'i.I_D_5_28',
                'i.I_D_5_29',
                'i.I_D_5_3',
                'i.I_D_5_30',
                'i.I_D_5_4',
                'i.I_D_5_5',
                'i.I_D_5_6',
                'i.I_D_5_7',
                'i.I_D_5_8',
                'i.I_D_5_9',
                'i.I_D_6_1',
                'i.I_D_6_10',
                'i.I_D_6_11',
                'i.I_D_6_12',
                'i.I_D_6_13',
                'i.I_D_6_14',
                'i.I_D_6_15',
                'i.I_D_6_16',
                'i.I_D_6_17',
                'i.I_D_6_18',
                'i.I_D_6_19',
                'i.I_D_6_2',
                'i.I_D_6_3',
                'i.I_D_6_4',
                'i.I_D_6_5',
                'i.I_D_6_6',
                'i.I_D_6_7',
                'i.I_D_6_8',
                'i.I_D_6_9',
                'i.I_D_7_1',
                'i.I_D_7_10',
                'i.I_D_7_11',
                'i.I_D_7_12',
                'i.I_D_7_13',
                'i.I_D_7_14',
                'i.I_D_7_15',
                'i.I_D_7_16',
                'i.I_D_7_17',
                'i.I_D_7_18',
                'i.I_D_7_19',
                'i.I_D_7_2',
                'i.I_D_7_20',
                'i.I_D_7_3',
                'i.I_D_7_4',
                'i.I_D_7_5',
                'i.I_D_7_6',
                'i.I_D_7_7',
                'i.I_D_7_8',
                'i.I_D_7_9',
                'i.I_D_8_1',
                'i.I_D_8_10',
                'i.I_D_8_11',
                'i.I_D_8_12',
                'i.I_D_8_13',
                'i.I_D_8_14',
                'i.I_D_8_15',
                'i.I_D_8_16',
                'i.I_D_8_17',
                'i.I_D_8_18',
                'i.I_D_8_19',
                'i.I_D_8_2',
                'i.I_D_8_20',
                'i.I_D_8_21',
                'i.I_D_8_22',
                'i.I_D_8_23',
                'i.I_D_8_24',
                'i.I_D_8_3',
                'i.I_D_8_4',
                'i.I_D_8_5',
                'i.I_D_8_6',
                'i.I_D_8_7',
                'i.I_D_8_8',
                'i.I_D_8_9',
                'i.I_D_9_1',
                'i.I_D_9_10',
                'i.I_D_9_11',
                'i.I_D_9_12',
                'i.I_D_9_13',
                'i.I_D_9_14',
                'i.I_D_9_15',
                'i.I_D_9_16',
                'i.I_D_9_17',
                'i.I_D_9_18',
                'i.I_D_9_19',
                'i.I_D_9_2',
                'i.I_D_9_20',
                'i.I_D_9_21',
                'i.I_D_9_22',
                'i.I_D_9_23',
                'i.I_D_9_24',
                'i.I_D_9_25',
                'i.I_D_9_26',
                'i.I_D_9_27',
                'i.I_D_9_28',
                'i.I_D_9_29',
                'i.I_D_9_3',
                'i.I_D_9_30',
                'i.I_D_9_31',
                'i.I_D_9_32',
                'i.I_D_9_33',
                'i.I_D_9_34',
                'i.I_D_9_35',
                'i.I_D_9_36',
                'i.I_D_9_4',
                'i.I_D_9_5',
                'i.I_D_9_6',
                'i.I_D_9_7',
                'i.I_D_9_8',
                'i.I_D_9_9',
                'i.II_A_1',
                'i.II_A_10',
                'i.II_A_11',
                'i.II_A_12',
                'i.II_A_2',
                'i.II_A_3',
                'i.II_A_4',
                'i.II_A_5',
                'i.II_A_6',
                'i.II_A_7',
                'i.II_A_8',
                'i.II_A_9',
                'i.II_B_1',
                'i.II_B_2',
                'i.II_B_3',
                'i.II_B_4',
                'i.II_B_5',
                'i.II_B_6',
                'i.II_C_1',
                'i.II_C_10',
                'i.II_C_11',
                'i.II_C_12',
                'i.II_C_13',
                'i.II_C_14',
                'i.II_C_15',
                'i.II_C_16',
                'i.II_C_17',
                'i.II_C_2',
                'i.II_C_3',
                'i.II_C_4',
                'i.II_C_5',
                'i.II_C_6',
                'i.II_C_7',
                'i.II_C_8',
                'i.II_C_9',
                'i.II_D_1',
                'i.II_D_10',
                'i.II_D_11',
                'i.II_D_12',
                'i.II_D_13',
                'i.II_D_2',
                'i.II_D_3',
                'i.II_D_4',
                'i.II_D_5',
                'i.II_D_6',
                'i.II_D_7',
                'i.II_D_8',
                'i.II_D_9',
                'i.II_E_1',
                'i.II_E_10',
                'i.II_E_11',
                'i.II_E_12',
                'i.II_E_13',
                'i.II_E_14',
                'i.II_E_15',
                'i.II_E_2',
                'i.II_E_3',
                'i.II_E_4',
                'i.II_E_5',
                'i.II_E_6',
                'i.II_E_7',
                'i.II_E_8',
                'i.II_E_9',
                'i.II_F_replacement',
                'i.II_F_replacement_comments',
                'i.II_F_replacement_comments_status',
                'i.II_F_replacement_examples',
                'i.II_F_replacement_examples_status',
                'i.later_gestures_number',
                'i.later_gestures_percentile',
                'i.phrases_understood_number',
                'i.phrases_understood_percentile');
        } else if ($this->instrument == 'csbs') {
            $fields = array('i.object_use_weighted',
            'i.Candidate_Age',
            'i.date_coded_date',
            'i.relationship_to_child',
            'i.q_1_alertness',
            'i.q_2_emotional_reaction',
            'i.q_3_level_of_interest',
            'i.q_4_comfort_level',
            'i.q_5_level_of_activity',
            'i.q_6_level_of_communication',
            'i.q_7_play_behaviour',
            'i.comments',
            'i.emotion_eye_gaze_standard',
            'i.emotion_eye_gaze_percentile',
            'i.communication_standard',
            'i.communication_percentile',
            'i.gestures_standard',
            'i.gestures_percentile',
            'i.sounds_standard',
            'i.sounds_percentile',
            'i.words_standard',
            'i.words_percentile',
            'i.understanding_standard',
            'i.understanding_percentile',
            'i.object_use_standard',
            'i.object_use_percentile',
            'i.social_composite_score',
            'i.social_composite_standard',
            'i.social_composite_percentile',
            'i.speech_composite_score',
            'i.speech_composite_standard',
            'i.speech_composite_percentile',
            'i.symbolic_composite_score',
            'i.symbolic_composite_standard',
            'i.symbolic_composite_percentile',
            'i.total_weighted_raw_score',
            'i.total_standard',
            'i.total_percentile',
            'i.q_1_gaze_shifts_1',
            'i.q_1_gaze_shifts_2',
            'i.q_1_gaze_shifts_3',
            'i.q_1_gaze_shifts_4',
            'i.q_1_gaze_shifts_5',
            'i.q_1_gaze_shifts_6',
            'i.q_1_gaze_shifts_raw_score',
            'i.q_2_shared_positive_affect_1',
            'i.q_2_shared_positive_affect_2',
            'i.q_2_shared_positive_affect_3',
            'i.q_2_shared_positive_affect_4',
            'i.q_2_shared_positive_affect_5',
            'i.q_2_shared_positive_affect_6',
            'i.q_2_shared_positive_affect_raw_score',
            'i.q_3_gaze_point_following_2',
            'i.q_3_gaze_point_following_5',
            'i.q_3_gaze_point_following_raw_score',
            'i.emotion_eye_gaze_weighted',
            'i.q_4_rate_of_communicating_1',
            'i.q_4_rate_of_communicating_2',
            'i.q_4_rate_of_communicating_3',
            'i.q_4_rate_of_communicating_4',
            'i.q_4_rate_of_communicating_5',
            'i.q_4_rate_of_communicating_6',
            'i.q_4_rate_of_communicating_raw_score',
            'i.q_5_behaviour_regulation_1',
            'i.q_5_behaviour_regulation_2',
            'i.q_5_behaviour_regulation_3',
            'i.q_5_behaviour_regulation_4',
            'i.q_5_behaviour_regulation_5',
            'i.q_5_behaviour_regulation_6',
            'i.q_5_behaviour_regulation_raw_score',
            'i.q_6_social_interaction_1',
            'i.q_6_social_interaction_2',
            'i.q_6_social_interaction_3',
            'i.q_6_social_interaction_4',
            'i.q_6_social_interaction_5',
            'i.q_6_social_interaction_6',
            'i.q_6_social_interaction_raw_score',
            'i.q_7_joint_attention_1',
            'i.q_7_joint_attention_2',
            'i.q_7_joint_attention_3',
            'i.q_7_joint_attention_4',
            'i.q_7_joint_attention_5',
            'i.q_7_joint_attention_6',
            'i.q_7_joint_attention_raw_score',
            'i.communication_weighted',
            'i.q_8_conventional_gestures_gives',
            'i.q_8_conventional_gestures_shows',
            'i.q_8_conventional_gestures_pushes_pulls',
            'i.q_8_conventional_gestures_reaches',
            'i.q_8_conventional_gestures_raw_score',
            'i.q_8_conventional_gestures_points',
            'i.q_8_conventional_gestures_waves',
            'i.q_8_conventional_gestures_nods_head',
            'i.q_8_conventional_gestures_shakes_head',
            'i.q_9_distal_gestures_1',
            'i.q_9_distal_gestures_2',
            'i.q_9_distal_gestures_3',
            'i.q_9_distal_gestures_4',
            'i.q_9_distal_gestures_5',
            'i.q_9_distal_gestures_6',
            'i.q_9_distal_gestures_raw_score',
            'i.gestures_weighted',
            'i.q_10_syllables_consonants_1',
            'i.q_10_syllables_consonants_2',
            'i.q_10_syllables_consonants_3',
            'i.q_10_syllables_consonants_4',
            'i.q_10_syllables_consonants_5',
            'i.q_10_syllables_consonants_6',
            'i.q_10_syllables_consonants_raw_score',
            'i.q_11_inventory_of_consonants_m',
            'i.q_11_inventory_of_consonants_n',
            'i.q_11_inventory_of_consonants_b_p',
            'i.q_11_inventory_of_consonants_d_t',
            'i.q_11_inventory_of_consonants_g_k',
            'i.q_11_inventory_of_consonants_raw_score',
            'i.q_11_inventory_of_consonants_w',
            'i.q_11_inventory_of_consonants_l',
            'i.q_11_inventory_of_consonants_y',
            'i.q_11_inventory_of_consonants_s',
            'i.q_11_inventory_of_consonants_sh',
            'i.sounds_weighted',
            'i.q_12_words_1',
            'i.q_12_words_2',
            'i.q_12_words_3',
            'i.q_12_words_4',
            'i.q_12_words_5',
            'i.q_12_words_6',
            'i.q_12_words_raw_score',
            'i.q_13_words_1',
            'i.q_13_words_2',
            'i.q_13_words_3',
            'i.q_13_words_4',
            'i.q_13_words_raw_score',
            'i.q_13_words_5',
            'i.q_13_words_6',
            'i.q_13_words_7',
            'i.q_13_words_8',
            'i.q_13_words_9',
            'i.q_13_words_10',
            'i.q_13_words_11',
            'i.q_13_words_12',
            'i.q_13_words_13',
            'i.q_13_words_14',
            'i.q_13_words_15',
            'i.q_13_words_16',
            'i.q_14_word_combos_1',
            'i.q_14_word_combos_2',
            'i.q_14_word_combos_3',
            'i.q_14_word_combos_4',
            'i.q_14_word_combos_5',
            'i.q_14_word_combos_6',
            'i.q_14_word_combos_raw_score',
            'i.q_15_word_combos_1',
            'i.q_15_word_combos_2',
            'i.q_15_word_combos_raw_score',
            'i.q_15_word_combos_3',
            'i.q_15_word_combos_4',
            'i.q_15_word_combos_5',
            'i.q_15_word_combos_6',
            'i.q_16_language_comp_raw_score',
            'i.q_15_word_combos_7',
            'i.q_15_word_combos_8',
            'i.words_weighted',
            'i.wind_up_admin',
            'i.q_16_language_comp_objects_1_name',
            'i.balloon_admin',
            'i.q_16_language_comp_objects_1',
            'i.bubbles_admin',
            'i.q_16_language_comp_objects_2_name',
            'i.jar_admin',
            'i.q_16_language_comp_objects_2',
            'i.books_admin',
            'i.q_16_language_comp_objects_3_name',
            'i.play_admin',
            'i.q_16_language_comp_objects_3',
            'i.q_16_language_comp_objects_4_name',
            'i.q_16_language_comp_objects_4',
            'i.q_16_language_comp_person_1_name',
            'i.q_16_language_comp_person_1',
            'i.q_16_language_comp_person_2_name',
            'i.q_16_language_comp_person_2',
            'i.q_16_language_comp_person_3_name',
            'i.q_16_language_comp_person_3',
            'i.q_16_language_comp_body_parts_1_name',
            'i.q_16_language_comp_body_parts_1',
            'i.q_16_language_comp_body_parts_2_name',
            'i.q_16_language_comp_body_parts_2',
            'i.q_16_language_comp_body_parts_3_name',
            'i.q_16_language_comp_body_parts_3',
            'i.q_16_language_comp_body_parts_4_name',
            'i.q_16_language_comp_body_parts_4',
            'i.understanding_weighted',
            'i.q_17_action_schemes_puts_in',
            'i.q_17_action_schemes_puts_on',
            'i.q_17_action_schemes_drinks_with_bottle',
            'i.q_17_action_schemes_drinks_with_cup',
            'i.q_18_actions_towards_other_raw_score',
            'i.q_17_action_schemes_hugs',
            'i.q_17_action_schemes_kisses',
            'i.q_17_action_schemes_feeds_with_utensil',
            'i.q_17_action_schemes_feeds_with_bowl',
            'i.q_17_action_schemes_stirs',
            'i.q_17_action_schemes_scoops',
            'i.q_17_action_schemes_pours',
            'i.q_19_sequence_action_schemes_raw_score',
            'i.q_17_action_schemes_other',
            'i.q_17_action_schemes_other_specify',
            'i.q_17_action_schemes_none',
            'i.q_17_action_schemes_raw_score',
            'i.q_18_action_towards_other_1',
            'i.q_18_action_towards_other_1_agent',
            'i.q_18_action_towards_other_1_agent_specify',
            'i.q_18_action_towards_other_2',
            'i.q_18_action_towards_other_2_agent',
            'i.q_18_action_towards_other_2_agent_specify',
            'i.q_18_action_towards_other_3',
            'i.q_18_action_towards_other_3_agent',
            'i.q_18_action_towards_other_3_agent_specify',
            'i.q_18_action_towards_other_4',
            'i.q_18_action_towards_other_4_agent',
            'i.q_18_action_towards_other_4_agent_specify',
            'i.q_18_action_towards_other_5',
            'i.q_18_action_towards_other_5_agent',
            'i.q_18_action_towards_other_5_agent_specify',
            'i.q_18_action_towards_other_6',
            'i.q_18_action_towards_other_6_agent',
            'i.q_18_action_towards_other_6_agent_specify',
            'i.q_19_sequence_action_schemes_1_action1',
            'i.q_19_sequence_action_schemes_1_action2',
            'i.q_19_sequence_action_schemes_2_action1',
            'i.q_19_sequence_action_schemes_2_action2',
            'i.q_19_sequence_action_schemes_3_action1',
            'i.q_19_sequence_action_schemes_3_action2',
            'i.q_19_sequence_action_schemes_4_action1',
            'i.q_19_sequence_action_schemes_4_action2',
            'i.q_19_sequence_action_schemes_5_action1',
            'i.q_19_sequence_action_schemes_5_action2',
            'i.q_19_sequence_action_schemes_6_action1',
            'i.q_19_sequence_action_schemes_6_action2',
            'i.q_20_stacks_tower',
            'i.q_20_stacks_tower_raw_score');
        } else if($this->instrument == 'ibq_r') {
            $fields = array('i.Candidate_Age', 'i.activity_level', 'i.approach', 'i.cuddliness', 'i.distress_to_limitations', 'i.duration_of_orienting', 'i.falling_reactivity', 'i.fear', 'i.high_pleasure', 'i.low_pleasure', 'i.perceptual_sensitivity', 'i.sadness', 'i.smiling_and_laughter', 'i.soothability', 'i.vocal_reactivity', 'i.q_1', 'i.q_10', 'i.q_100', 'i.q_101', 'i.q_102', 'i.q_103', 'i.q_104', 'i.q_105', 'i.q_106', 'i.q_107', 'i.q_108', 'i.q_109', 'i.q_11', 'i.q_110', 'i.q_111', 'i.q_112', 'i.q_113', 'i.q_114', 'i.q_115', 'i.q_116', 'i.q_117', 'i.q_118', 'i.q_119', 'i.q_12', 'i.q_120', 'i.q_121', 'i.q_122', 'i.q_123', 'i.q_124', 'i.q_125', 'i.q_126', 'i.q_127', 'i.q_128', 'i.q_129', 'i.q_13', 'i.q_130', 'i.q_131', 'i.q_132', 'i.q_133', 'i.q_134', 'i.q_135', 'i.q_136', 'i.q_137', 'i.q_138', 'i.q_139', 'i.q_14', 'i.q_140', 'i.q_141', 'i.q_142', 'i.q_143', 'i.q_144', 'i.q_145', 'i.q_146', 'i.q_147', 'i.q_148', 'i.q_149', 'i.q_15', 'i.q_150', 'i.q_151', 'i.q_152', 'i.q_153', 'i.q_154', 'i.q_155', 'i.q_156', 'i.q_157', 'i.q_158', 'i.q_159', 'i.q_16', 'i.q_160', 'i.q_161', 'i.q_162', 'i.q_163', 'i.q_164', 'i.q_165', 'i.q_166', 'i.q_167', 'i.q_168', 'i.q_169', 'i.q_17', 'i.q_170', 'i.q_171', 'i.q_172', 'i.q_173', 'i.q_174', 'i.q_175', 'i.q_176', 'i.q_177', 'i.q_178', 'i.q_179', 'i.q_18', 'i.q_180', 'i.q_181', 'i.q_182', 'i.q_183', 'i.q_184', 'i.q_185', 'i.q_186', 'i.q_187', 'i.q_188', 'i.q_189', 'i.q_19', 'i.q_190', 'i.q_191', 'i.q_2', 'i.q_20', 'i.q_21', 'i.q_22', 'i.q_23', 'i.q_24', 'i.q_25', 'i.q_26', 'i.q_27', 'i.q_28', 'i.q_29', 'i.q_3', 'i.q_30', 'i.q_31', 'i.q_32', 'i.q_33', 'i.q_34', 'i.q_35', 'i.q_36', 'i.q_37', 'i.q_38', 'i.q_39', 'i.q_4', 'i.q_40', 'i.q_41', 'i.q_42', 'i.q_43', 'i.q_44', 'i.q_45', 'i.q_46', 'i.q_47', 'i.q_48', 'i.q_49', 'i.q_5', 'i.q_50', 'i.q_51', 'i.q_52', 'i.q_53', 'i.q_54', 'i.q_55', 'i.q_56', 'i.q_57', 'i.q_58', 'i.q_59', 'i.q_6', 'i.q_60', 'i.q_61', 'i.q_62', 'i.q_63', 'i.q_64', 'i.q_65', 'i.q_66', 'i.q_67', 'i.q_68', 'i.q_69', 'i.q_7', 'i.q_70', 'i.q_71', 'i.q_72', 'i.q_73', 'i.q_74', 'i.q_75', 'i.q_76', 'i.q_77', 'i.q_78', 'i.q_79', 'i.q_8', 'i.q_80', 'i.q_81', 'i.q_82', 'i.q_83', 'i.q_84', 'i.q_85', 'i.q_86', 'i.q_87', 'i.q_88', 'i.q_89', 'i.q_9', 'i.q_90', 'i.q_91', 'i.q_92', 'i.q_93', 'i.q_94', 'i.q_95', 'i.q_96', 'i.q_97', 'i.q_98', 'i.q_99');
        } else if ($this->instrument == 'head_measurements_subject') {
            $fields = array('i.head_circumference1', 'i.head_circumference1_status', 'i.head_circumference2', 'i.head_circumference2_status', 'i.length1', 'i.length1_status', 'i.length2', 'i.length2_status', 'i.measurement_method', 'i.weight1', 'i.weight1_status', 'i.weight2', 'i.weight2_status');
        } else if ($this->instrument == 'prefrontal_task') {
            $fields = array('i.training', 'i.training_finds_partially_covered', 'i.training_finds_fully_covered', 'i.training_retrieves_R_well', 'i.training_retrieves_R_well_trial', 'i.training_retrieves_R_well_trial_of', 'i.training_retrieves_L_well', 'i.training_retrieves_L_well_trial', 'i.training_retrieves_L_well_trial_of', 'i.start_side', 'i.trial_1', 'i.trial_2', 'i.trial_3', 'i.trial_4', 'i.trial_5', 'i.trial_6', 'i.trial_7', 'i.trial_8', 'i.trial_9', 'i.trial_10', 'i.trial_11', 'i.trial_12', 'i.trial_13', 'i.trial_14', 'i.trial_15', 'i.trial_16', 'i.trial_17', 'i.trial_18', 'i.trial_19', 'i.trial_20', 'i.trial_21', 'i.trial_22', 'i.trial_23', 'i.trial_24', 'i.first_reversal', 'i.second_reversal', 'i.third_reversal', 'i.fourth_reversal', 'i.validity_of_data', 'i.invalidity_reason', 'i.invalidity_comment', 'i.invalidity_comment_status', 'i.5sec_overall_correct', 'i.5sec_overall_trials', 'i.5sec_reversals_correct', 'i.5sec_reversals_trials', 'i.12sec_overall_correct', 'i.12sec_overall_trials', 'i.12sec_reversals_correct', 'i.12sec_reversals_trials');
        }
        return implode($fields, ", ");
    }

    function getFields() {
        return $this->getCommonFields() . $this->getInstrumentFields();
    }

    function getQuery() {
        if($this->instrument == 'demographics') {
            return "SELECT DISTINCT IBISID, CandidateGUID, ProbandGUID, Gender, ProbandGender, c.CenterID, DoB, CASE s.SubprojectID WHEN 1 THEN 'High Risk' WHEN 2 THEN 'High Risk' WHEN 3 THEN 'Control' END as Cohort FROM candidate c JOIN session s ON (s.CandID=c.CandID) WHERE c.Active='Y' AND s.Active='Y' AND c.CandidateGUID IS NOT NULL";
        }
        return "SELECT " . $this->getFields() . " FROM " . $this->instrument . " i JOIN flag f ON (f.CommentID=i.CommentID) JOIN session s ON (s.ID=f.SessionID) JOIN candidate c ON (c.CandID=s.CandID) WHERE " . $this->getWhere();
    }

    function process($results) {
        $converted = array();
        foreach($results as $row) {
            if($this->instrument === 'adi_r_proband') {
                if($row['BNV_Total'] == 'Verbal') {
                    $row['subject_verbal'] = 'yes';
                }  else if($row['BV_Total'] == 'Nonverbal') {
                    $row['subject_verbal'] = 'no';
                } else {
                    $row['subject_verbal'] = '';
                }
            }
            foreach($row as $key => $val) {
                if($key == 'Date_taken' || $key == 'DoB') {
                    $Date = explode('-', $val);
                    $row['Date_taken'] = $Date[1] . '/' . '01' . '/' . $Date[0];
                }
                if($this->instrument == 'adi_r_proband') {
                    if($key == 'Total_B2V' || $key == 'Total_B3V' || $key == 'BV_Total' || $key == 'BNV_Total') {
                        if($val == 'Verbal' || $val == 'Nonverbal') {
                            $row[$key] = '';
                        }
                    }

                    if(strpos($key, 'q_') === 0 || $key === 'informant_relation') {
                        $matches = array();
                        if(preg_match('/(\d+)_(.*)/', $val, $matches) === 1) {
                            $row[$key] = $matches[1];
                        }

                    }
                }
            }
            
            $converted[] = $row;
        }
        return $converted;
    }

    function writeResults($results, $filename) {
        $fd = fopen($filename, 'w+');
        if($fd === FALSE) {
            exit(-1);
        }
        fputcsv($fd,array_keys($results[0]));
        foreach($results as $row) {
            fputcsv($fd, $row);
        }
        return $fd;
    }
    function run() {
        $factory = NDB_Factory::singleton();
        $Query = $this->getQuery();
        
        $db = $factory->Database();
        if($this->instrument == 'scq_proband' || $this->instrument == 'scq_subject') {
            $results = $db->pselect($Query . " AND i.scq_version='lifetime'", array());
            $converted = $this->process($results);
            $this->writeResults($converted, './' . $this->instrument . '_lifetime.csv');
            $results = $db->pselect($Query . " AND i.scq_version='current'", array());
            $converted = $this->process($results);
            $this->writeResults($converted, './' . $this->instrument . '_current.csv');
        } else {
            $results = $db->pselect($Query, array());
            $converted = $this->process($results);
            $this->writeResults($converted, './' . $this->instrument . '.csv');
        }
        return $converted;
    }
}
?>
